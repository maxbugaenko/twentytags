<?$this->headTitle("TwentyTags - ".$this->entity->title)?>
<div class="toTop">
    <button id="to-top-button" class="header-button header-button-large to-top">
        <i class="fa fa-angle-double-up"></i> Up
    </button>
</div>
<div class="entity-container">
    <div class="entity">
        <div class="item">
            <div class="item-image">
                <img src="<?=$this->staticFile("images/entities/".$this->entity->picture)?>">
            </div>
            <div class="item-content">
                <div class="item-title"><?=$this->entity->title?></div>
                <div class="item-tags">
                    <?$tagged = Model_Tag::retrieveTaggedTagsByEntity($this->entity);?>
                    <? foreach ($tagged as $tag):?>
                        <a class="gray-link link-underline" href="<?=$this->url(array("id"=>$tag, Model_Static_Functions::dashString($tag->value)=>""), "tags", false)?>"><?=$tag->value?></a>&#160;
                    <? endforeach?>
                </div>
                <div class="item-info">
                    <i class="header-button facebook fa fa-facebook-square"></i>
                    <i class="header-button twitter fa fa-twitter"></i>
                    <i class="header-button google fa fa-google-plus-square"></i>
                </div>
                <div class="item-description">
                    <?=$this->entity->description?>
                </div>
                <div class="item-info">
                    <button class="header-button google header-button-large"><i class="fa fa-check-square"></i> Follow</button>
                </div>
            </div>
        </div>
    </div>
    <div class="alerts <?if (count($this->dates) == 0) { echo "add-no-alerts-margin"; }?>">
        <?if (count($this->dates) > 0):?>
            <?foreach ($this->dates as $date):?>
                <?$alerts = Model_Alert::retrieveByEntityAndDate($this->entity, $date->dates);?>
                <div class="list">
                    <? foreach ($alerts as $item):?>
                        <div class="data">
                            <? if ($item->source == "youtube"):?>
                                <div class="youtube">
                                    <i class="fa fa-youtube"></i>
                                </div>
                            <? endif;?>
                            <div class="data-title">
                                <a class="red-link" href="<?=$item->link?>"><?=$item->title?></a>
                                <span class="body"><?=$item->body?></span> <span class="date"><?=date("F jS, Y",strtotime($item->added));?></span>
                            </div>
                            <div class="data-controls">
                                <i class="header-button fa fa-sort-asc"></i>
                            </div>
                        </div>
                    <?endforeach?>
                </div>
            <?endforeach?>
        <?else:?>
            <div class="message">
                <div class="message-title"><i class="fa fa-clock-o"></i><br/>There is no updates yet</div>
                <div class="message-description">
                    We've got to wait a little. Either follow this tag or get back later
                </div>
            </div>
        <?endif?>
    </div>
</div>
<script>
    $(document).scroll(function () {
        var y = $(this).scrollTop();
        if (y > 800) {
            $('.toTop').fadeIn();
        } else {
            $('.toTop').fadeOut();
        }
    });
    $(document).ready (function() {
        $("#to-top-button").click(function() {
            $('html, body').animate({ scrollTop: 0 }, 'slow');
        });
    });
</script>